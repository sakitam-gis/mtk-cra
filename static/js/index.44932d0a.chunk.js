(this["webpackJsonpmtk-cra"]=this["webpackJsonpmtk-cra"]||[]).push([[0],{574:function(e,t,a){e.exports={title:"index_title__3ZWHCb"}},602:function(e,t,a){e.exports={mapWarp:"index_mapWarp__pBXsD1",map:"index_map__2L_-yr"}},603:function(e,t,a){e.exports={wrap:"main_wrap__3HRfaP"}},615:function(e,t,a){},619:function(e,t,a){},698:function(e,t,a){},699:function(e,t,a){e.exports={layerSwitch:"index_layerSwitch__12SNpe",ulWrap:"index_ulWrap__NICxln",liWrap:"index_liWrap__dckhA9",selected:"index_selected__1ldeHd",checkbox:"index_checkbox__3Y1Q6z"}},705:function(e,t,a){"use strict";a.r(t);var n=a(66),r=a(702),i=a(0),s=a.n(i),o=a(178),l=a(138),u=a(180),c=a(179),d=(a(599),a(554)),h=a(602),p=a.n(h),v=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,e,n)).setRef=function(e){e&&r.createMap(e)},r.state={mapLoaded:!1},r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"createMap",value:function(e){e&&(this.map=new d.i(e,{center:[104.21,36.42],zoom:7,minZoom:2,maxZoom:13,baseLayer:new d.f("group",[new d.n("base",{urlTemplate:"https://mt{s}.google.cn/vt/lyrs=y&hl=zh-CN&gl=CN&src=app&x={x}&y={y}&z={z}&s=G",subdomains:[1,2,3],repeatWorld:!0})])}),window.map=this.map,this.setState({mapLoaded:!0}))}},{key:"render",value:function(){var e=this.props.children,t=this.state.mapLoaded,a=[];return Array.isArray(e)?a=e:a.push(e),Object(n.a)("div",{className:p.a.mapWarp},void 0,s.a.createElement("div",{ref:this.setRef,className:p.a.map}),t&&a)}}]),a}(i.Component),f=a(603),m=a.n(f),y=a(60),b=a.n(y),k=a(552),g=a(41),O=a(604),j=a.n(O),x=a(573),S=a.n(x),L=a(281),w=a.n(L),C=a(283),_=a.n(C),P=a(282),N=a.n(P),D=a(606),T=a.n(D),R=a(284),H=a.n(R);function I(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{interval:6,paddingRight:!0,paddingLeft:!0},n=w()(e),r=w()(t),i=r.diff(n,"minute"),s=Math.floor(i/a.interval)+(a.paddingLeft?1:0)+(a.paddingRight?1:0),o=[],l="",u=0;u<s;u++){if(0===u){var c=n.minute(),d=c+a.interval-c%a.interval,h=d-(a.paddingLeft&&d>=a.interval?a.interval:0);l=h>59?n.set("hour",n.hour()+1):n.minute(h)}else l=l.add(a.interval,"minute");(l.isSameOrBefore(r)||l.isSameOrAfter(r)&&a.paddingRight)&&o.push({id:l.format("YYYYMMDDHHmm"),time:l.format("HH:mm"),fullTime:l,formatTime:l.format("YYYY.MM.DD HH:mm")})}return o}w.a.extend(T.a),w.a.extend(_.a),w.a.extend(N.a),w.a.extend(H.a);var E=w.a;var F=a(701),M=null;function W(e){return z.apply(this,arguments)}function z(){return(z=Object(k.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(M){e.next=4;break}return e.next=3,Object(F.a)(t,1,{upgrade:function(e){A(e,"idb")}});case 3:M=e.sent;case 4:return e.abrupt("return",M);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e,t,a){try{return e.transaction(t,a).objectStore(t)}catch(n){return!1}}function A(e,t){return Y.apply(this,arguments)}function Y(){return(Y=Object(k.a)(b.a.mark((function e(t,a){var n,r,i=arguments;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>2&&void 0!==i[2]?i[2]:"readwrite",!(r=V(t,a,n)))try{r=t.createObjectStore(a,{})}catch(s){console.error(s)}return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}for(var B="idb",G=[],U=15;U<=255;U+=30)for(var Z=15;Z<=255;Z+=30)for(var J=15;J<=255;J+=30)G.push([U,Z,J]);function Q(){return(Q=Object(k.a)(b.a.mark((function e(){var t,a,n,r,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=E(),a=t.hour(),n=a-a%6,t=t.hour(n),r=t.add(7,"d"),i=I(t,r,{interval:180,paddingRight:!0,paddingLeft:!0}),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t){var a=G.length;return{lineWidth:0,lineColor:"#000",lineOpacity:0,polygonFill:"rgb("+G[Math.round(Math.random()*(a-1))].join()+")",polygonOpacity:.4}}function q(){for(var e=[],t=-150;t<150;t++)for(var a=-150;a<150;a++)e.push([t,a,{symbol:X()}]);return{projection:!0,center:[104.21,36.42],width:2e3,height:2e3,data:e}}function K(e){return $.apply(this,arguments)}function $(){return($=Object(k.a)(b.a.mark((function e(t){var a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W("mtk-cra");case 2:return a=e.sent,e.next=5,a.get(B,t);case 5:if(n=e.sent){e.next=10;break}return n=q(),e.next=10,ee(t,n);case 10:return e.abrupt("return",{code:200,data:n,msg:"success"});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(e,t){return te.apply(this,arguments)}function te(){return(te=Object(k.a)(b.a.mark((function e(t,a){var n,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W("mtk-cra");case 2:return n=e.sent,e.next=5,n.put(B,a,t);case 5:return e.next=7,n.getAll(B);case 7:return r=e.sent,e.abrupt("return",{code:200,data:r,msg:"success"});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}console.log(G.length);var ae=a(597),ne=a(141),re=a(607),ie=a(612),se=a.n(ie),oe=(a(285),a(78)),le=a(574),ue=a.n(le),ce=a(54),de=a.n(ce),he=a(45),pe=a(703),ve=a(65),fe=a(48),me=a.n(fe);function ye(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=document.createElement("div");return r.className=t||"own-popup",de.a.render(Object(n.a)(oe.a,{locale:pe.a},void 0,Object(n.a)(he.a,{store:ve.default._store},void 0,s.a.createElement(e,a))),r),r}var be={Test:function(e){var t=e.className,a=Object(i.useMemo)((function(){return me()("test-popup",t)}),[t]);return Object(n.a)("div",{className:a},void 0,Object(n.a)("h2",{className:ue.a.title},void 0,e.label),e.label)},getPopupContent:ye},ke=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,n,r){var i;return Object(o.a)(this,a),(i=t.call(this)).id=e,i.map=n,i.layerId="",i.makeField(),i.data=[],r&&i.setData(r),i}return Object(l.a)(a,[{key:"makeField",value:function(){this.layerId="".concat(this.id,"-layer")}},{key:"setData",value:function(e){var t=e.features.filter((function(e){return e.geometry}));this.data={type:"FeatureCollection",features:t||[]},this.updateFeature()}},{key:"updateFeature",value:function(){this.data&&(this.features=d.e.toGeometry(this.data))}},{key:"clearData",value:function(){this.setData({features:[]})}},{key:"getData",value:function(){return this.data}},{key:"remove",value:function(){}},{key:"checkLayer",value:function(e){return this.map.getLayer(e)}},{key:"addLayers",value:function(){throw Error("should overwride")}},{key:"removeLayers",value:function(){var e=this.checkLayer(this.layerId);e&&(this.map.removeLayer(e),this.layer=null)}},{key:"addEvents",value:function(){this.removeEvents()}},{key:"removeEvents",value:function(){}},{key:"setPopup",value:function(e,t,a){be[e]||console.warn("\u4e0d\u5b58\u5728\u7684\u6c14\u6ce1\u7c7b\u578b - [".concat(e,"]"));var n=ye(be[e],"",a);this.popup=new d.t.InfoWindow({single:!0,autoCloseOn:!0,width:300,height:"auto",custom:!0,dx:a.dx,dy:a.dy,content:n}).show(t)}},{key:"openPopup",value:function(){this.popup&&this.popup.addTo(this.map)}},{key:"removePopup",value:function(){this.popup&&this.popup.remove()}},{key:"destroyed",value:function(){this.map&&(this.removeLayers(),this.removeEvents())}}]),a}(se.a),ge=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,n,r){var i,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(o.a)(this,a),(i=t.call(this,e,n,r)).options=s,i.addLayers(),i}return Object(l.a)(a,[{key:"setData",value:function(e){this.data=e||null;var t=this.checkLayer(this.layerId);t&&t.setGrid(this.data,0)}},{key:"addLayers",value:function(){if(!this.checkLayer(this.layerId)){var e=new re.a(this.layerId,this.data,{symbol:{lineWidth:0}});this.map.addLayer(e),this.addEvents()}}},{key:"removeLayers",value:function(){var e=this.checkLayer(this.layerId);e&&this.map.removeLayer(e)}},{key:"addEvents",value:function(){Object(ae.a)(Object(ne.a)(a.prototype),"addEvents",this).call(this)}},{key:"removeEvents",value:function(){}}]),a}(ke),Oe=(a(575),a(596)),je=(a(286),a(128)),xe=a(571),Se=a.n(xe),Le=(a(576),a(595)),we=a(252),Ce=(a(615),a(553)),_e=a.n(Ce),Pe=void 0,Ne=Object(n.a)("span",{className:"sakitam-player__menu-text"},void 0,"\u56fe\u5c42"),De=Object(n.a)("span",{className:"sakitam-player__speed-text"},void 0,"\u901f\u5ea6"),Te=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,e,n)).initPlayer=function(){var e=r.props.interval;r.state.isPlaying&&(r.timer=setTimeout((function(){r.handleAutoPlay()}),e))},r.handleAutoPlay=function(){(0,r.props.next)(r.autoPlayCallback)},r.autoPlayCallback=function(e){var t=r.getSlider();if(t){t.next(),r.clearTimer(),r.initPlayer();var a=t.getValue();_e()(e)&&e(a)}},r.prevCallback=function(e){var t=r.getSlider();if(t){t.prev();var a=t.getValue();_e()(e)&&e(a)}},r.nextCallback=function(e){var t=r.getSlider();if(t){t.next();var a=t.getValue();_e()(e)&&e(a)}},r.handlePrev=function(){(0,r.props.prev)(r.prevCallback)},r.handleNext=function(){(0,r.props.next)(r.nextCallback)},r.handleLayerType=function(){(0,r.props.onLayerChange)()},r.handlePlayState=function(){var e=r.props,t=e.preStart,a=e.onPlayState;r.setState((function(e){return Object(g.a)(Object(g.a)({},e),{},{isPlaying:!e.isPlaying})}),(function(){var e=r.state.isPlaying;e?t(Object(we.a)(r),(function(){r.initPlayer()})):r.clearTimer(),a(e)}))},r.state={isPlaying:!1},r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props,a=t.autoplay,n=t.immediate,r=t.preStart;a&&(this.setState({isPlaying:!0}),r(this,(function(){n&&e.handleAutoPlay(),e.initPlayer()})))}},{key:"componentWillUnmount",value:function(){this.stop()}},{key:"stop",value:function(){this.setState({isPlaying:!1}),this.clearTimer()}},{key:"resetPlayer",value:function(){this.setState({isPlaying:!1}),this.clearTimer();var e=this.getSlider();e&&e.resetIndex()}},{key:"getSlider",value:function(){return this.props.sliderRef.current}},{key:"getNextValue",value:function(){var e=this.getSlider();return e?e.getNextValue():null}},{key:"getPrevValue",value:function(){var e=this.getSlider();return e?e.getPrevValue():null}},{key:"clearTimer",value:function(){this.timer&&(clearTimeout(this.timer),this.timer=null)}},{key:"render",value:function(){var e,t,a=this.props,r=a.children,i=a.layerContent,s=a.speedContent,o=a.showLayerSwitch,l=a.labelOptions,u=a.overlayClassName,c=this.state.isPlaying;return Object(n.a)("div",{className:"sakitam-player"},void 0,o&&Object(n.a)(Le.a,{className:"menu-tooltip__radar",placement:"topLeft",overlay:i||""},void 0,Object(n.a)("span",{className:"sakitam-player__layer"},void 0,Object(n.a)("span",{onClick:this.handleLayerType,className:"sakitam-player__layer-icon iconfont icon-tuceng2"}),Ne)),Object(n.a)("span",{className:"sakitam-player__menu"},void 0,Object(n.a)("span",{onClick:this.handlePlayState,className:me()({"sakitam-player__menu-icon":!0,playing:c})}),Object(n.a)("span",{className:"sakitam-player__menu-text"},void 0,c?null===l||void 0===l||null===(e=l.menuLabel)||void 0===e?void 0:e.pause:null===l||void 0===l||null===(t=l.menuLabel)||void 0===t?void 0:t.play)),Object(n.a)("span",{className:"sakitam-player__back"},void 0,Object(n.a)("span",{onClick:this.handlePrev,className:"sakitam-player__back-icon"}),Object(n.a)("span",{className:"sakitam-player__back-text"},void 0,null===l||void 0===l?void 0:l.backLabel)),r||null,Object(n.a)("span",{className:"sakitam-player__next"},void 0,Object(n.a)("span",{onClick:this.handleNext,className:"sakitam-player__next-icon"}),Object(n.a)("span",{className:"sakitam-player__next-text"},void 0,null===l||void 0===l?void 0:l.nextLabel)),Object(n.a)(Le.a,{className:"menu-tooltip__radar",placement:"top",arrowPointAtCenter:!0,overlayClassName:u,overlay:s||""},void 0,Object(n.a)("span",{className:"sakitam-player__speed"},void 0,Object(n.a)("span",{onClick:this.handleLayerType,className:me()({"sakitam-player__speed-icon":!0})}),De)))}}]),a}(i.Component);Te.defaultProps={showLayerSwitch:!1,onLayerChange:function(){},onPlayState:function(){},labelOptions:{menuLabel:{play:"\u64ad\u653e",pause:"\u6682\u505c"},backLabel:"\u4e0a\u4e00\u4e2a",nextLabel:"\u4e0b\u4e00\u4e2a"},next:function(e){_e()(e)&&e.call(Pe)},prev:function(e){_e()(e)&&e.call(Pe)},preStart:function(e){_e()(e)&&e.call(Pe)},immediate:!1,autoplay:!1,interval:3e3,layerContent:"",speedContent:""};var Re=Te,He=(a(617),a(700)),Ie=(a(619),a(620)),Ee=a.n(Ie),Fe=a(594),Me=a.n(Fe),We=a(593),ze=a.n(We),Ve=a(550),Ae=a.n(Ve);function Ye(e,t,a){if(e&&e.length>0){var n=Ee()(e,(function(e){return e.id===t}));return void 0===(null===n||void 0===n?void 0:n[a])||(null===n||void 0===n?void 0:n[a])}return!0}var Be=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,r){var i;return Object(o.a)(this,a),(i=t.call(this,e,r)).handleChange=function(e){var t=i.props,a=t.onChange,n=t.data,r=100/(n.length-1),s=Math.floor(e/r);i.index=s;var o=Ee()(n,(function(e,t){return t===s}));i.setState({value:e}),a&&_e()(a)&&a("inner",o)},i.tipFormatter=function(e){var t=i.state.marks;return"string"===typeof t[e]?Object(n.a)("span",{},void 0,t[e]):Ae()(t[e])?Object(n.a)("span",{},void 0,t[e].formatTime):""},i.state={marks:{}},i.sliderRef=s.a.createRef(),i.index=0,i}return Object(l.a)(a,null,[{key:"getDerivedStateFromProps",value:function(e,t){var a=function(e){for(var t=e.data,a=e.filterData,n=t.length-1,r=100/n,i={},s=0;s<=n;s++){var o=t[s],l=o.time,u=o.id;i[s*r]={style:{display:Ye(a,u,"showLabel")?"block":"none",color:"#fff"},label:l,formatTime:t[s].formatTime}}return i}(e);if(!S()(a,t.marks))return{marks:a||[]};if(!Me()(e.value)&&!S()(e.value,t.value)){var n=e.data;return{value:100/(n.length-1)*ze()(n,(function(t){var a;return(null===t||void 0===t?void 0:t.id)===(null===(a=e.value)||void 0===a?void 0:a.id)}))}}return null}}]),Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"setValueByIndex",value:function(e){var t=this.props,a=t.data,n=t.onChange,r=100/(a.length-1);this.setState({value:r*e});var i=Ee()(a,(function(t,a){return a===e}));n&&_e()(n)&&n("outer",i)}},{key:"prev",value:function(){this.sliderRef&&this.sliderRef.current&&(this.index=this.index-1>0?this.index-1:0,this.setValueByIndex(this.index))}},{key:"next",value:function(){var e=this.props,t=e.data,a=e.loop;if(this.sliderRef&&this.sliderRef.current){var n=t.length-1;this.index=this.index+1<=n?this.index+1:a?0:n,this.setValueByIndex(this.index)}}},{key:"resetIndex",value:function(){var e=this.props.value;this.index=0,this.setState({value:e})}},{key:"getValue",value:function(){return this.state}},{key:"getPrevValue",value:function(){var e=this.props,t=e.data,a=e.loop,n=this.index;if(this.sliderRef&&this.sliderRef.current){var r=t.length-1;n=this.index-1>0?this.index-1:a?r:0}return Ee()(t,(function(e,t){return t===n}))}},{key:"getNextValue",value:function(){var e=this.props,t=e.data,a=e.loop,n=this.index;if(this.sliderRef&&this.sliderRef.current){var r=t.length-1;n=this.index+1<=r?this.index+1:a?0:r}return Ee()(t,(function(e,t){return t===n}))}},{key:"render",value:function(){var e=this.props,t=e.step,a=e.className,r=e.min,i=e.max,o=e.vertical,l=e.included,u=e.dots,c=e.onBeforeChange,d=e.onAfterChange,h=e.handleStyle,p=e.trackStyle,v=e.railStyle,f=e.dotStyle,m=e.activeDotStyle,y=this.state,b=y.marks,k=y.value;return Object(n.a)("span",{className:me()("sakitam-slider",a)},void 0,s.a.createElement(He.a,{value:k,defaultValue:k,ref:this.sliderRef,tooltipVisible:!0,min:r,max:i,marks:b,step:t,vertical:o,included:l,dots:u,tipFormatter:this.tipFormatter,onBeforeChange:c,onAfterChange:d,handleStyle:h,trackStyle:p,railStyle:v,dotStyle:f,activeDotStyle:m,onChange:this.handleChange}))}}]),a}(i.Component);Be.defaultProps={min:0,max:100,loop:!0,step:null,dotStyle:{backgroundColor:"rgba(255, 255, 255, 0.9)"},activeDotStyle:{borderColor:"#fff"},railStyle:{},trackStyle:{backgroundColor:"rgba(0, 0, 0, 0.633)"},handleStyle:{border:"2px solid #9cd5ff",backgroundColor:"rgba(255, 255, 255, 0.7)",boxShadow:"inset 0 0 10px 5px rgba(80, 175, 255, 0.7)"}};var Ge=Be,Ue=a(698),Ze=a.n(Ue),Je=Object(n.a)(Oe.a.Button,{value:2e3},void 0,"\u6162"),Qe=Object(n.a)(Oe.a.Button,{value:1e3},void 0,"\u4e2d"),Xe=Object(n.a)(Oe.a.Button,{value:500},void 0,"\u5feb"),qe=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,r){var i;return Object(o.a)(this,a),(i=t.call(this,e,r)).state={marks:[],hasData:!1,speed:1e3,showSlider:!0,filterData:[],data:[],current:{}},i.handleSliderChange=function(e,t){"inner"===e&&i.setState((function(e){return Object(g.a)(Object(g.a)({},e),{},{current:t})}),(function(){i.updateLayerData()}))},i.tipFormatter=function(e){var t=i.state.marks;return"string"===typeof t[e]?Object(n.a)("span",{},void 0,t[e]):Object(n.a)("span",{},void 0,t[e].label)},i.onAfterChange=function(e){var t=i.state.marks[e];t&&i.setState((function(e){return Object(g.a)(Object(g.a)({},e),{},{level:t.value})}),(function(){i.updateLayerData()}))},i.handleSpeedChange=function(e){var t;i.setState({speed:Number((null===e||void 0===e||null===(t=e.target)||void 0===t?void 0:t.value)||1e3)})},i.handlePrev=function(e){if(i.sliderRef&&i.sliderRef.current){var t=i.sliderRef.current.getPrevValue();i.setState((function(e){return Object(g.a)(Object(g.a)({},e),{},{current:t})}),(function(){i.updateLayerData().then((function(a){if(!i.mounted)return!1;a?e((function(){console.log("prev",t)})):je.b.error("\u4e0a\u4e00\u5e27\u6570\u636e\u83b7\u53d6\u5931\u8d25")}))}))}},i.handleNext=function(e){if(i.sliderRef&&i.sliderRef.current){var t=i.sliderRef.current.getNextValue();i.setState((function(e){return Object(g.a)(Object(g.a)({},e),{},{current:t})}),(function(){i.updateLayerData().then((function(t){if(!i.mounted)return!1;t?e((function(){})):je.b.error("\u4e0b\u4e00\u5e27\u6570\u636e\u83b7\u53d6\u5931\u8d25")}))}))}},i.resizeHandlerInner=function(){var e=i.sliderRef;if(e&&e.current){var t=de.a.findDOMNode(e.current),a=i.times.length,n=t.clientWidth,r=38*a,s=Math.ceil(r/n),o=i.times.map((function(e,t){return Object(g.a)(Object(g.a)({},e),{},{showStep:t%s===0,showLabel:t%s===0})}));i.setState({filterData:o})}},i.createSpeed=function(){var e=i.state.speed;return Object(n.a)("div",{className:"speed-switch"},void 0,Object(n.a)(Oe.a.Group,{defaultValue:e,onChange:i.handleSpeedChange,buttonStyle:"solid"},void 0,Je,Qe,Xe))},i.layerId="grid",i.sliderRef=s.a.createRef(),i.times=[],i.message=null,i.mounted=!1,i}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.mounted=!0;var e=this.props.throttleEvent;this.updateTimeList(),this.initLayer(),this.resizeHandler=e?Se()(this.resizeHandlerInner,50):this.resizeHandlerInner,window.addEventListener("resize",this.resizeHandler)}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.layer&&this.layer.destroyed(),this.message&&this.closeLoading(this.message),window.removeEventListener("resize",this.resizeHandler)}},{key:"updateTimeList",value:function(){var e=this,t=E(),a=t.hour(),n=a-a%6,r=(t=t.hour(n)).add(7,"d"),i=I(t,r,{interval:60,paddingRight:!0,paddingLeft:!0});this.times=i;var s=i[0];this.setState((function(e){return Object(g.a)(Object(g.a)({},e),{},{current:s,data:i,showSlider:!0})}),(function(){e.resizeHandler(),s&&e.updateLayerData()}))}},{key:"initLayer",value:function(){}},{key:"updateLayerData",value:function(){return Promise.resolve()}},{key:"handlePreLoad",value:function(e,t){e.state.isPlaying&&t.call(e)}},{key:"closeLoading",value:function(e){e&&e(),this.message=null}},{key:"render",value:function(){var e=this.state,t=e.showSlider,a=e.speed,r=e.filterData,i=e.data,o=e.current;return Object(n.a)("div",{className:Ze.a.wrap},void 0,t&&Object(n.a)(Re,{autoplay:!1,interval:a,prev:this.handlePrev,next:this.handleNext,preStart:this.handlePreLoad,sliderRef:this.sliderRef,speedContent:this.createSpeed(),overlayClassName:"slider-speed-wrap"},void 0,s.a.createElement(Ge,{value:o,data:i,filterData:r,breakLine:!0,ref:this.sliderRef,onChange:this.handleSliderChange})))}}]),a}(s.a.Component);qe.defaultProps={throttleEvent:!0,onLayerInit:function(){},onLayerUpdate:function(){}};var Ke=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,e,n)).layerId="grid",r}return Object(l.a)(a,null,[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.params;return S()(a,t.params)?null:{params:a}}}]),Object(l.a)(a,[{key:"componentDidMount",value:function(){this.mounted=!0;var e=this.props.throttleEvent;this.updateTimeList(),this.initLayer(),this.resizeHandler=e?j()(this.resizeHandlerInner,50):this.resizeHandlerInner,window.addEventListener("resize",this.resizeHandler),this.fetchList()}},{key:"getSnapshotBeforeUpdate",value:function(e){var t=e.params;return t||null}},{key:"componentDidUpdate",value:function(e,t,a){var n=this.props.params;n&&a&&!S()(n,a)&&this.fetchList()}},{key:"initLayer",value:function(){var e=this.times[0];this.layer=new ge(this.layerId,window.map,e)}},{key:"updateTimeList",value:function(){var e=this,t=this.times[0];this.setState((function(a){return Object(g.a)(Object(g.a)({},a),{},{current:t,data:e.times,showSlider:!0})}),(function(){e.resizeHandler(),t&&e.updateLayerData()}))}},{key:"fetchList",value:function(){var e=this,t=this.props.params,a=E();(function(){return Q.apply(this,arguments)})({dataType:null===t||void 0===t?void 0:t.dataType,startTime:a.format("YYYYMMDDHHmm"),endTime:a.add(2,"hour").format("YYYYMMDDHHmm")}).then((function(t){e.times=t;var a=e.times[0];e.setState((function(t){return Object(g.a)(Object(g.a)({},t),{},{current:a,data:e.times,showSlider:!0})}),(function(){a&&e.updateLayerData(),setTimeout((function(){e.resizeHandler()}),100)}))})).catch((function(t){console.error(t),e.setState({current:{},data:[]})}))}},{key:"updateLayerData",value:function(){var e=Object(k.a)(b.a.mark((function e(){var t,a,n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.current,a=this.props.onLayerUpdate,this.message&&this.closeLoading(this.message),e.prev=3,e.next=6,K(null===t||void 0===t?void 0:t.id);case 6:if(n=e.sent,this.mounted){e.next=9;break}return e.abrupt("return",!1);case 9:return n&&200===n.code&&this.layer&&(this.layer.setData(null===n||void 0===n?void 0:n.data),a&&a(this.layer)),e.abrupt("return",!0);case 13:return e.prev=13,e.t0=e.catch(3),console.log(e.t0),this.closeLoading(this.message),e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e,this,[[3,13]])})));return function(){return e.apply(this,arguments)}}()}]),a}(qe),$e=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,n,r){var i,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(o.a)(this,a),(i=t.call(this,e,n,r)).options=s,i.addLayers(),i}return Object(l.a)(a,[{key:"addLayers",value:function(){this.checkLayer(this.layerId)||(this.layer=new d.p(this.layerId,this.data,{enableSimplify:!1,style:[{symbol:{lineColor:{property:"color",type:"identity"},lineWidth:1.5,markerType:"ellipse",markerFill:{property:"color",type:"identity"},markerFillOpacity:.9,markerWidth:55,markerHeight:55,markerLineWidth:0,textFaceName:"sans-serif",textName:"{label}",textWeight:"normal",textStyle:"normal",textSize:13,textFont:null,textFill:"#34495e",textOpacity:1,textHaloFill:"#fff",textHaloRadius:1,textWrapWidth:null,textWrapCharacter:"\n",textLineSpacing:0,textDx:0,textDy:0,textHorizontalAlignment:"middle",textVerticalAlignment:"middle",textAlign:"center"}}]}),this.map.addLayer(this.layer),this.addEvents())}},{key:"updateFeature",value:function(){this.data&&(this.features=d.e.toGeometry(this.data)),this.layer&&(this.layer.clear(),this.layer.addGeometry(this.features))}},{key:"removeLayers",value:function(){var e=this.checkLayer(this.layerId);e&&this.map.removeLayer(e)}},{key:"handleClick",value:function(e){var t=this;this.map.identify({coordinate:e.coordinate,layers:[this.layer]},(function(e){console.log(t,e),t.emit("click",e.filter((function(e){return"MultiPoint"!==e.type})))}))}},{key:"addEvents",value:function(){Object(ae.a)(Object(ne.a)(a.prototype),"addEvents",this).call(this),this.map.on("click",this.handleClick,this)}},{key:"removeEvents",value:function(){this.map.off("click",this.handleClick,this)}}]),a}(ke),et=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e,n){var r;return Object(o.a)(this,a),(r=t.call(this,e,n)).state={},r.lists=[],r.layerId="RealTime",r.selectFeature=null,r.message=null,r.mounted=!1,r}return Object(l.a)(a,[{key:"componentDidMount",value:function(){this.mounted=!0,this.initLayer()}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.selectFeature&&this.selectFeature.removePopup(),this.message&&(this.message&&this.message(),this.message=null),this.layer&&this.layer.destroyed()}},{key:"handleClick",value:function(e){if(e&&e.length>0){var t=e[0],a=t.getProperties();be.Test||console.warn("\u4e0d\u5b58\u5728\u7684\u6c14\u6ce1\u7c7b\u578b - [Test]");var n=ye(be.Test,"",a);t.setInfoWindow({content:n,autoPan:!0,width:120,custom:!0,autoCloseOn:!0,dx:0,dy:5}),setTimeout((function(){t.openInfoWindow()}))}else console.log("click none")}},{key:"initLayer",value:function(){this.layer=new $e(this.layerId,window.map,{type:"FeatureCollection",features:[{type:"Feature",properties:{color:"#fe7316",label:"TEST1"},geometry:{type:"Point",coordinates:[104.21,36.42]}},{type:"Feature",properties:{color:"#1bc8ff",label:"TEST2"},geometry:{type:"Point",coordinates:[103.21,36.42]}}]},{}),this.layer.on("click",this.handleClick,this)}},{key:"render",value:function(){return null}}]),a}(s.a.Component),tt=a(590),at=a.n(tt),nt=a(699),rt=a.n(nt),it=function(e){Object(u.a)(a,e);var t=Object(c.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).onChange=function(e){n.setState({panelSelected:e});var t=n.props.onChange;t&&_e()(t)&&t(e)},n.state={panelSelected:{}},n}return Object(l.a)(a,null,[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.tabs,n=e.defaultValue,r=t.panelSelected;if(Me()(r)){if(n)return{panelSelected:n};if(a&&a.length>0)return{panelSelected:at()(a,"0",{})}}return null}}]),Object(l.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.tabs,a=e.className,r=this.state.panelSelected;return Object(n.a)("div",{className:me()(a,rt.a.layerSwitch)},void 0,Object(n.a)(Oe.a.Group,{className:rt.a.checkbox,options:t,defaultValue:Array.isArray(r)?r:r.value,onChange:this.onChange}))}}]),a}(s.a.Component);it.defaultProps={tabs:[]};var st=it,ot=[{label:"RealTime",value:"RealTime",checked:!0},{label:"Archives",value:"Archives"}];t.default=function(e){var t=Object(i.useState)(ot[0].value),a=Object(r.a)(t,2),o=a[0],l=a[1],u=Object(i.useRef)(null),c=Object(i.forwardRef)((function(e,t){return"RealTime"===o?s.a.createElement(et,Object.assign({ref:t},e)):s.a.createElement(Ke,Object.assign({ref:t},e))}));return console.log(u.current),Object(n.a)("div",{className:m.a.wrap},void 0,Object(n.a)(v,{},void 0,Object(n.a)(st,{tabs:ot,onChange:function(e){console.log(e.target.value),l(e.target.value)}}),s.a.createElement(c,{ref:u})))}}}]);